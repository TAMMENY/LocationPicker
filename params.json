{
  "name": "Locationpicker",
  "tagline": "百度地图指针选址",
  "body": "<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\">\r\n<html xmlns=\"http://www.w3.org/1999/xhtml\">\r\n\r\n<head>\r\n    <meta http-equiv=\"content-type\" content=\"text/html; charset=UTF-8\">\r\n    <meta name=\"viewport\" content=\"width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0\" />\r\n    <meta name=\"apple-mobile-web-app-capable\" content=\"yes\" />\r\n    <!-- 删除苹果默认的工具栏和菜单栏 -->\r\n    <meta name=\"apple-mobile-web-app-status-bar-style\" content=\"black\" />\r\n    <!-- 设置苹果工具栏颜色 -->\r\n    <!-- 启用360浏览器的极速模式(webkit) -->\r\n    <meta name=\"renderer\" content=\"webkit\">\r\n    <!-- 避免IE使用兼容模式 -->\r\n    <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\">\r\n    <!-- 针对手持设备优化，主要是针对一些老的不识别viewport的浏览器，比如黑莓 -->\r\n    <meta name=\"HandheldFriendly\" content=\"true\">\r\n    <!-- 微软的老式浏览器 -->\r\n    <meta name=\"MobileOptimized\" content=\"320\">\r\n    <!-- uc强制竖屏 -->\r\n    <meta name=\"screen-orientation\" content=\"portrait\">\r\n    <!-- QQ强制竖屏 -->\r\n    <meta name=\"x5-orientation\" content=\"portrait\">\r\n    <!-- UC应用模式 -->\r\n    <meta name=\"browsermode\" content=\"application\">\r\n    <!-- QQ应用模式 -->\r\n    <meta name=\"x5-page-mode\" content=\"app\">\r\n    <!-- windows phone 点击无高光 -->\r\n    <meta name=\"msapplication-tap-highlight\" content=\"no\">\r\n    <!-- 适应移动端end -->\r\n    <title>百度地图拖拽选址</title>\r\n    <script type=\"text/javascript\" src=\"http://api.map.baidu.com/api?v=2.0&ak=BAf587e6e73a25a70ea2f1c8c54155df\"></script>\r\n    <style type=\"text/css\">\r\n    html,\r\n    body {\r\n        height: 100%;\r\n    }\r\n    \r\n    body {\r\n        font-size: 24px;\r\n        margin: 0;\r\n        font-family: \"微软雅黑\";\r\n        padding: 0;\r\n    }\r\n    \r\n    #container {\r\n        margin-right: 10px;\r\n        width: 100%;\r\n        height: 60%;\r\n        overflow: hidden;\r\n    }\r\n    \r\n    #info {\r\n        width: 100%;\r\n        height: 40%;\r\n        overflow-y: scroll;\r\n        font-size: 12px;\r\n        z-index: 10001;\r\n        background: #fff;\r\n        color: #000;\r\n        text-align: left;\r\n        margin: 0;\r\n        padding: 0;\r\n        position: absolute;\r\n        bottom: 0;\r\n        border-top: 1px solid #ddd;\r\n    }\r\n    \r\n    #info li {\r\n        border-bottom: 1px solid #ddd;\r\n    }\r\n    \r\n    #info h4 {\r\n        margin-bottom: 5px;\r\n    }\r\n    \r\n    #info p {\r\n        margin-top: 5px;\r\n        color: #666;\r\n    }\r\n    \r\n    #info h4,\r\n    #info p {\r\n        padding: 0 10px;\r\n    }\r\n    \r\n    #pointer {\r\n        color: #000;\r\n        text-align: center;\r\n        left: 50%;\r\n        top: 30%;\r\n        position: absolute;\r\n        -webkit-transform: translate(-50%, -50%);\r\n        -ms-transform: translate(-50%, -50%);\r\n        -o-transform: translate(-50%, -50%);\r\n        transform: translate(-50%, -50%);\r\n        z-index: 10001;\r\n        font-size: 28px;\r\n    }\r\n    \r\n    .search {\r\n        position: absolute;\r\n        top: 0;\r\n        font-size: 12px;\r\n        padding: 10px 0;\r\n        z-index: 10001;\r\n        text-align: center;\r\n        width: 100%;\r\n        background: #fff;\r\n    }\r\n    \r\n    .search input {\r\n        height: 25px;\r\n        outline: none;\r\n    }\r\n    \r\n    .tangram-suggestion-main {\r\n        top: 41px!important;\r\n        z-index: 10002;\r\n    }\r\n    </style>\r\n</head>\r\n\r\n<body>\r\n    <div class=\"search\">\r\n        <div id=\"r-result\">\r\n            <input type=\"text\" id=\"suggestId\" size=\"20\" value=\"\" style=\"width:95%;\" placeholder=\"请输入关键字\" />\r\n        </div>\r\n        <div id=\"searchResultPanel\" style=\"border:1px solid #C0C0C0;height:auto; display:none;\"></div>\r\n    </div>\r\n    <div id=\"pointer\">x</div>\r\n    <div id=\"container\"></div>\r\n    <ul id=\"info\">\r\n    </ul>\r\n    <script type=\"text/javascript\">\r\n    var geolocation = new BMap.Geolocation();\r\n    var currentLng = 113.421931,\r\n        currentLat = 23.173148;\r\n    geolocation.getCurrentPosition(function(r) {\r\n        if (this.getStatus() == BMAP_STATUS_SUCCESS) {\r\n            map.panTo(r.point);\r\n            currentLng = r.point.lng;\r\n            currentLat = r.point.lat;\r\n        } else {\r\n            alert('failed' + this.getStatus());\r\n        }\r\n    }, {\r\n        enableHighAccuracy: true\r\n    });\r\n    var map = new BMap.Map(\"container\");\r\n    var mPoint = new BMap.Point(currentLng, currentLat);\r\n    map.centerAndZoom(mPoint, 16);\r\n    map.addControl(new BMap.NavigationControl({\r\n        type: BMAP_NAVIGATION_CONTROL_SMALL\r\n    }));\r\n    map.enableScrollWheelZoom();\r\n    var mOption = {\r\n        poiRadius: 1000, //半径为1000米内的POI,默认100米\r\n        numPois: 10 //列举出10个POI,默认10个\r\n    }\r\n    map.addEventListener(\"moveend\", function(e) { //鼠标拖动事件  \r\n        var gc = new BMap.Geocoder();\r\n        gc.getLocation(new BMap.Point(map.getCenter().lng, map.getCenter().lat),\r\n            function mCallback(rs) {\r\n                var allPois = rs.surroundingPois; //获取全部POI（该点半径为100米内有6个POI点）\r\n                var poisList = \"\";\r\n                for (i = 0; i < allPois.length; ++i) {\r\n                    console.info(allPois[i].title + \"，\" + allPois[i].address);\r\n                    poisList += \"<li><h4>\" + allPois[i].title + \"</h4><p>\" + allPois[i].address + \"</p></li>\";\r\n                }\r\n                document.getElementById(\"info\").innerHTML = poisList;\r\n            }, mOption\r\n        );\r\n    });\r\n    function G(id) {\r\n        return document.getElementById(id);\r\n    }\r\n    var ac = new BMap.Autocomplete( //建立一个自动完成的对象\r\n        {\r\n            \"input\": \"suggestId\",\r\n            \"location\": map\r\n        });\r\n    ac.addEventListener(\"onhighlight\", function(e) { //鼠标放在下拉列表上的事件\r\n        var str = \"\";\r\n        var _value = e.fromitem.value;\r\n        var value = \"\";\r\n        if (e.fromitem.index > -1) {\r\n            value = _value.province + _value.city + _value.district + _value.street + _value.business;\r\n        }\r\n        str = \"FromItem<br />index = \" + e.fromitem.index + \"<br />value = \" + value;\r\n        value = \"\";\r\n        if (e.toitem.index > -1) {\r\n            _value = e.toitem.value;\r\n            value = _value.province + _value.city + _value.district + _value.street + _value.business;\r\n        }\r\n        str += \"<br />ToItem<br />index = \" + e.toitem.index + \"<br />value = \" + value;\r\n        G(\"searchResultPanel\").innerHTML = str;\r\n    });\r\n    var myValue;\r\n    ac.addEventListener(\"onconfirm\", function(e) { //鼠标点击下拉列表后的事件\r\n        var _value = e.item.value;\r\n        myValue = _value.province + _value.city + _value.district + _value.street + _value.business;\r\n        G(\"searchResultPanel\").innerHTML = \"onconfirm<br />index = \" + e.item.index + \"<br />myValue = \" + myValue;\r\n        setPlace();\r\n    });\r\n    function setPlace() {\r\n        function myFun() {\r\n            var pp = local.getResults().getPoi(0).point; //获取第一个智能搜索的结果\r\n            map.centerAndZoom(pp, 18);\r\n        }\r\n        var local = new BMap.LocalSearch(map, { //智能搜索\r\n            onSearchComplete: myFun\r\n        });\r\n        local.search(myValue);\r\n    }\r\n    </script>\r\n</body>\r\n\r\n</html>",
  "note": "Don't delete this file! It's used internally to help with page regeneration."
}